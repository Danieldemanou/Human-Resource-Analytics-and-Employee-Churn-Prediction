---
title: "Human Resource Analytics"
output:
  html_document: default
  pdf_document: default
---


---



```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


#### Loading The required packages
```{r  , message=FALSE,warning=FALSE}
library(ggplot2)
library(dplyr)

```


```{r,message=FALSE,warning=FALSE}
#loading the Dataset

hrm<-read.csv('HR_comma_sep.csv')

#Structure of the Dataset
str(hrm)
attach(hrm)

#converting left variable to factor variable 
hrm$left<-ifelse(left==1,'True','False')

hrm$left<-factor(hrm$left,levels=c("True","False"))
table(hrm$left)

#Summary Statistics of the dataset
summary(hrm)




```


---

<h3>Satisfaction level statistics splitted by salary ranges</h3>
```{r}

by(hrm$satisfaction_level,hrm$salary,summary)

#Histogram

p1<-ggplot(aes(x=satisfaction_level),data=hrm) + 
  geom_histogram(color="black",fill="red",bins = 30) +
  labs(title="Satisfaction level Histogram",x='Satisfaction Level of Employees', y="Frequency")

p1



    
#Satisfaction level histogram facetted by sallary classes

p2 =  p1  + facet_wrap(~salary)
p2

```

---

<ul style="font-size:18px">
<li> The disrtibution of satisfaction level for each class of Salary Ranges is almost same.</li>
<li> The High salary employees have a little bit higher mean satisfaction level.</li>
<li>
Employees with High salary are less in number.
</li>
</ul>

```{r}
by(satisfaction_level,left,summary)
#As peedicted the satifaction level of employees who left was lower

#Sstisfaction level vs left
ggplot(aes(x = satisfaction_level),data=hrm) + 
  geom_histogram(color='black',fill='green',bins=35) +
  xlab('Satisfaction Level') + 
  ylab("Frequency")  + 
  facet_wrap(~left)
  

#Boxplot for Satisfaction level vs left
ggplot(aes(x = left,y=satisfaction_level),data= hrm) + 
  geom_boxplot() + 
  ylab('Satisfaction Level') + 
  xlab("Employee left") + 
  labs(fill="Salary Classes")

#Boxplot for Satisfaction level vs left facetted by Salary Ranges
ggplot(aes(x = left,y=satisfaction_level),data= hrm) + 
  geom_boxplot() + 
  ylab('Satisfaction Level') + 
  xlab("Employee left") + 
  facet_wrap(~salary)

table(hrm$left , salary)

#Testing for the dependence between left and salary Ranges
#Both are categorial variables so we use Chisq Test statistic
chisq.test(left,salary)




```
### X-squared value is high and p-value is less i.e results are significant.Both variables are related

---

## Analysis on number of Projects



```{r}
hrm$number_project<-factor(hrm$number_project)

ggplot(aes(x=number_project),data = hrm) + 
  geom_bar(color='black',fill='#234338') +
  xlab("Number of Projects") + 
  ylab("Frequency") + 
  labs(title="Barplot of Number of projects")





#boxplot of number of projects vs  Average monthly hours at workplace of employees
p3=ggplot(aes(x=number_project, y = average_montly_hours),data=hrm)+
  geom_boxplot()

p4=p3+facet_wrap(~salary)
p4

p5=p3+facet_wrap(~left) + labs(title="Number projects Vs Avg monthly hours worked faceted by Left")
p5


#facetted by salary
ggplot(aes(x=number_project),data = hrm) + 
  geom_bar(color='black',fill='#834338') +
  xlab("Number of Projects") + 
  ylab("Frequency") + 
  labs(title="Barplot of Number of projects faceted by Salary") +
  facet_wrap(~salary)


#faceted by If a employee left or not
ggplot(aes(x=number_project),data = hrm) + 
  geom_bar(color='black',fill='#547398') +
  xlab("Number of Projects") + 
  ylab("Frequency") + 
  labs(title="Barplot of Number of projects faceted by Left")+  
  facet_wrap(~left)
  

```

---

## Analysis on Average Number of Hours a Employee works

```{r}
#Analysis of average monthly hours
summary(average_montly_hours)
#Somewhat Normally distributed

ggplot(aes(x= average_montly_hours),data = hrm)+
  geom_histogram(color='black',fill="yellow",bins = 30)


cor.test(satisfaction_level,average_montly_hours)
#No relation between both the variables -  as r is eqv to 0

```



```{r}

ggplot(aes(x = average_montly_hours),data =hrm ) + 
  geom_histogram(color='black',fill='#443332',bins = 30) + 
  facet_wrap(~left)

by(average_montly_hours , hrm$left ,summary)

ggplot(aes(y = average_montly_hours, x = hrm$left),data=hrm)+
  geom_boxplot() + 
  xlab("Employee left or not") + 
  ylab("Average Montly hours worked")



```

### A thing to notice is that employee who left the company worked more hours than those who did not leave, hence it might be possible that they left bacause they were over pressurized by their peers or bosses or over worked or stressed with lots of work




## Anslysis for variable Time spend at company
```{r}
table(hrm$time_spend_company)

ggplot(aes(x = factor(time_spend_company)),data = hrm) + 
  geom_bar(fill = 'purple',color='black') + 
  xlab("Time spend at compnay in years") + 
  ylab("Frequency")+
  labs(title = "Barplot of Time spend at Company")


#Time spend at company vs Left or not

ggplot(aes(x = factor(time_spend_company)),data = hrm) + 
  geom_bar(fill = 'grey',color='black') + 
  xlab("Time spend at compnay in years") + 
  ylab("Frequency")+
  labs(title = "Barplot of Time spend at Company faceted by Left")  +
  facet_wrap(~left)

by(time_spend_company , left , summary)

ggplot(aes(x = left , y = time_spend_company),data = hrm)+
  geom_boxplot()



```

